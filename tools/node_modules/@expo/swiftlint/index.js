"use strict";

const fs = require("fs");
const os = require("os");
const path = require("path");
const spawnAsync = require("@expo/spawn-async");

const platform = os.platform();
const arch = os.arch();
const buildDir = `${platform}-${arch}`;
const swiftLintPath = path.join(__dirname, "bin", buildDir, "swiftlint");

module.exports = function main(args = [], options = {}) {
  return spawnAsync(swiftLintPath, args, {
    cwd: process.cwd(),
    ...options,
    env: {
      ...process.env,
      LINUX_SOURCEKIT_LIB_PATH: "/usr/share/swift/usr/lib",
      ...options.env,
    },
  });
};
